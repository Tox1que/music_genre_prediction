# [Kaggle-соревнование](https://www.kaggle.com/competitions/music-genre-prediction-m124ds/leaderboard) по определению музыкального жанра

### Описание проекта  
Стриминговый сервис "МиФаСоль" расширяет работу с новыми артистами и музыкантами, в связи с чем возникла задача – правильно классифицировать новые музыкальные треки, чтобы улучшить работу рекомендательной системы. Коллеги из отдела работы со звуком подготовили датасет, в котором собраны некоторые характеристики музыкальных произведений и их жанры. Задача – разработать модель, позволяющую классифицировать музыкальные произведения по жанрам.  

### Описание данных:  
`instance_id` - уникальный идентификатор трека;  
`track_name` - название трека;  
`acousticness` - акустичность;  
`danceability` - танцевальность;  
`duration_ms` - продолжительность в милисекундах;  
`energy` - энергичность;  
`instrumentalness` - инструментальность;  
`key` - базовый ключ (нота) произведения;  
`liveness` - привлекательность;  
`loudness` - громкость;  
`mode` - указывает на модальность (мажорную или минорную) трека;  
`speechiness` - выразительность;  
`tempo` - темп;  
`obtained_date` - дата загрузки в сервис;  
`valence` - привлекательность произведения для пользователей сервиса.  

**Целевой признак:**  
`music_genre` - музыкальный жанр.  

### Предварительный анализ данных:  
- в полученных наборах данных обнаружены пропуски, аномальные значения и выбросы;  
- явные дубликаты отсутствуют;  
- распределения числовых переменных в обучающей и тестовой выборке похожи;  
- неинформативный признак `instance_id` удалён.  

### Предобработка данных:  
- обнаружена сильная корреляция между признаками `loudness`, `acousticness` и `energy`;  
- проведён анализ переменных с точки зрения целевого признака;  
- на основе переменной с высокой кардинальностью `track_name` созданы новые признаки;  
- пропуски в категориальных переменных заполнены с использованием моделей случайного леса,  
    в числовых (в т.ч. значения `-1` в столбце `duration_ms`) – линейной регрессии.  

### Выбор и обучение модели:  
- выполнен подбор гиперпараметров для моделей случайного леса, логистической регрессии и градиентного бустинга;  
- лучший результат продемонстрировал `CatBoostClassifier`, поэтому был выбран в качестве мета-модели в стекинге. 

### Полученные значения метрики F1-micro:  
- 0.53471 - тестовая выборка (Public);  
- 0.54392 - тестовая выборка (Private).
